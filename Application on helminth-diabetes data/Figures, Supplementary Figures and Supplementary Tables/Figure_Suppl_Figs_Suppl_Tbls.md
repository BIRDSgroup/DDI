# Instructions to get the Main Figures, Supplementary Figures, and Supplementary Tables
There are a total of 6 main figures, 7 supplementary figures, and 4 supplementary tables. 
This file will provide the necessary instructions to generate the figures, supplementary figures, and sheets given in the main text.

## Section 1 - Main Figures 
### Figure 1 - Methods Overview 

### Figure 2 - Data Overview
Run the ["Heatmaps_Script.R"](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/blob/26bbae2344943f81b10cf8dfd8a9558a16a10e53/Application%20on%20helminth-diabetes%20data/Scripts/Heatmaps/Heatmaps_Script.R) under the [**Scripts**](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/tree/987bcd0ff4ecaae35eec570c552b21f13ad0b0b3/Application%20on%20helminth-diabetes%20data/Scripts) section. Refer to the [Readme](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/blob/1aaa425683109655346223341a5b75c0e83b0a63/Application%20on%20helminth-diabetes%20data/Scripts/Heatmaps/Heatmaps_Script_Readme.md) file on how to run this script. This will generate **heatmap_fig2a.png** in the folder set as the working directory. 

### Figure 3 - Ternary plot
Two figures in the ternary plot:

1. Before treatment 
2. After treatment 

Run the ["MI_script.R"](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/blob/bc6704ea3221b41adb6e40a91735d8751d800b07/Application%20on%20helminth-diabetes%20data/Scripts/Main_and_Interaction/MI_Script.R) under the [**Scripts**](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/tree/987bcd0ff4ecaae35eec570c552b21f13ad0b0b3/Application%20on%20helminth-diabetes%20data/Scripts) section. This will generate both before and after-treatment ternary plots, which are for **Figure 3**. Refer to the [Readme](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/blob/6772a411d79ad1e053ac20b7e2bb3286f29f3493/Application%20on%20helminth-diabetes%20data/Scripts/Main_and_Interaction/MI_Script_Readme.md) file on how to run this script.

### Figure 4 - Replication analysis

Run the ["Validation_script.R"](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/blob/ee65c741df4c442d3dd4999b45d1d904c8fde3b6/Application%20on%20helminth-diabetes%20data/Scripts/Validation/Validation_Script.R) under the [**Script**](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/tree/987bcd0ff4ecaae35eec570c552b21f13ad0b0b3/Application%20on%20helminth-diabetes%20data/Scripts) section. This will generate the plots for **Figure 4**. Please take a look at the [Readme](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/blob/321c1f03f647dfc5596a123997a580f5c261f8d2/Application%20on%20helminth-diabetes%20data/Scripts/Validation/Validation_Script_Readme.md) file for reference.
Three figures in **Figure 4** (Check **Main_Figures** folder generated after running this script):

1. Replication.jpg
2. IFN-gamma.jpg
3. TNF-alpha.jpg
   
### Figure 5 - Source immune cells of some of the DDI markers

Run the ["Interpretation_script.R"](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/blob/a4c626f93a107d3b809e3a307fc26208423cff7f/Application%20on%20helminth-diabetes%20data/Scripts/Interpretation/Interpretation_Script.R) under the [**Script**](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/tree/987bcd0ff4ecaae35eec570c552b21f13ad0b0b3/Application%20on%20helminth-diabetes%20data/Scripts) section. **Figure_5.jpg** is generated in the folder **Figure_5_and_6** after running the script. Please take a look at the [Readme](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/blob/990e3bbe91ee5311c880e2a50eebe2116d8ae170/Application%20on%20helminth-diabetes%20data/Scripts/Interpretation/Interpretation_Script_Readme.md) file for reference.

### Figure 6 - Reactome pathway heatmap 

Run the ["Interpretation_script.R"](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/blob/a4c626f93a107d3b809e3a307fc26208423cff7f/Application%20on%20helminth-diabetes%20data/Scripts/Interpretation/Interpretation_Script.R) under the [**Script**](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/tree/987bcd0ff4ecaae35eec570c552b21f13ad0b0b3/Application%20on%20helminth-diabetes%20data/Scripts) section. **Figure_6.jpg** is generated in the folder **Figure_5_and_6** after running the script. Please take a look at the [Readme](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/blob/990e3bbe91ee5311c880e2a50eebe2116d8ae170/Application%20on%20helminth-diabetes%20data/Scripts/Interpretation/Interpretation_Script_Readme.md) file for reference.


## Section 2 - Supplementary Figures

### Supplementary Figure 1 - Heatmap
Run the ["Heatmaps_Script.R"](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/blob/26bbae2344943f81b10cf8dfd8a9558a16a10e53/Application%20on%20helminth-diabetes%20data/Scripts/Heatmaps/Heatmaps_Script.R) under the [**Scripts**](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/tree/987bcd0ff4ecaae35eec570c552b21f13ad0b0b3/Application%20on%20helminth-diabetes%20data/Scripts) section. Refer to the [Readme](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/blob/1aaa425683109655346223341a5b75c0e83b0a63/Application%20on%20helminth-diabetes%20data/Scripts/Heatmaps/Heatmaps_Script_Readme.md) file on how to run this script. This will generate **Suppl_Fig_2.png** in the folder set as the working directory. 

### Supplementary Figure 2a and 2b - Bayesian network reconstruction


### Supplementary Figures 3 and 4 
Run the ["MI_script.R"](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/blob/bc6704ea3221b41adb6e40a91735d8751d800b07/Application%20on%20helminth-diabetes%20data/Scripts/Main_and_Interaction/MI_Script.R) under the [**Scripts**](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/tree/987bcd0ff4ecaae35eec570c552b21f13ad0b0b3/Application%20on%20helminth-diabetes%20data/Scripts) section. This will generate two folders **Supp_Figure_3** and **Supp_Figure_4** which contain **.jpg** figures of the interaction plots used to obtain **Supplementary Figure 3** and **Supplementary Figure 4** from the manuscript respectively. Refer to the [Readme](https://github.com/BIRDSgroup/Double-disease-interaction-analysis-/blob/6772a411d79ad1e053ac20b7e2bb3286f29f3493/Application%20on%20helminth-diabetes%20data/Scripts/Main_and_Interaction/MI_Script_Readme.md) file on how to run this script.

### Supplementary Figure 5 - Residual plots
Run the function sup_5_fig() before implementing the code below which calls this function. The inputs to this function are the two outputs from **section 3** and **section 4.2** under **Main set of codes**.

```r
sup_5_fig <- function(id1, id2,bt_op, at_op){
  cmn_bt_at_main_var <- intersect(bt_op[[3]],at_op[[3]])
  some_at <- vector("numeric", length = nrow(id2))
  
  for(i in 1:nrow(id2)){
    some_at[i] <- (100 - sum(as.numeric(id2[[2]][i]),as.numeric(id2[[3]][i]),as.numeric(id2[[4]][i])))
  }
  
  
  some_bt <- vector("numeric", length = nrow(id1))
  
  for(i in 1:nrow(id1)){
    some_bt[i] <- (100 - sum(as.numeric(id1[[2]][i]),as.numeric(id1[[3]][i]),as.numeric(id1[[4]][i])))
  }
  
  some_bt_at_df <- data.frame(some_bt, some_at)
  
  some_ids <- which(id2[[1]] %in% cmn_bt_at_main_var)
  
  some_bt_at_df <- some_bt_at_df[some_ids,]
  
  vari_R <- c("Adipsin","Eosinophils","G-CSF","Glucagon","HbA1c","IFNg","IgG","IL-10","IL-12","IL-13","IL-17A","IL-17F","IL-1b","IL-2","IL-4","IL-5","IL-6","IL-8","Leptin","Lymphocytes","MCHC","MCP-1","MIP-1b","Monocytes","Neutrophils","RBG","Resistin","TGF-b","TNF-a","Visfatin")
  
  some_bt_at_df[,3] <- vari_R
  
  
  ggplot2::ggplot(data=some_bt_at_df, ggplot2::aes(x=some_bt,y=some_at))+ggrepel::geom_text_repel(label=vari_R, size=3)+ggplot2::theme(legend.text = element_text(size = 3))+xlab("Before Treatment Residuals")+ylab("After Treatment Residuals")+ggplot2::ylim(0,100)+ggplot2::xlim(0,100)
  
  
}


sup_5_fig(rela_df_BT, rela_df_AT,BT_main_inter,AT_main_inter)
```

### Supplementary figure 6 and 7

Run the code in **Section 4** in the **Replication analysis** file to obtain supplementary figures 6 and 7.

 

## Section 3 - Supplementary tables

### Supplementary Table 2 (Before-Treatment analysis data) and Supplementary Table 3 (After-Treatment analysis data)

There are 12 columns in these tables. They are **Features**, **Main effect p values**, **Main effect adjusted p values**, **Interaction effect p values**, **Interaction effect adjusted p values**, **b0 (Intercept coefficient)**, **b1 (Helminth term coefficient)**, **b2 (Diabetes term coefficient)**, **Relative explained variance (Helminth term)**, **Relative explained variance (Diabetes term)**, **Relative explained variance (Helminth:Diabetes interaction term)** and **Unexplained variance**.

#### Supplementary Table 2 


#### Supplementary Table 3


### Supplementary Table 4
Run the code in **Section 5** in the **Replication analysis** file, to obtain a text file containing the contents in the supplementary table 4.











